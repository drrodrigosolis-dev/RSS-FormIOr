% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CleaningSimplification.R
\name{ReviewDuplicateSubmissions}
\alias{ReviewDuplicateSubmissions}
\title{Interactively review and resolve duplicate submissions}
\usage{
ReviewDuplicateSubmissions(
  x,
  id_col = 1,
  key_cols = NULL,
  compare_cols = NULL,
  return_flat = FALSE,
  quiet = FALSE,
  keep_map = NULL,
  prompt = TRUE,
  default_keep = "all"
)
}
\arguments{
\item{x}{A data frame of responses, or a list from \code{\link[=FlattenSubmissions]{FlattenSubmissions()}}.}

\item{id_col}{Integer or character. Submission ID column (default 1).}

\item{key_cols}{Optional. Columns used to define "duplicate submissions"
(for example \code{username}, \code{email}, \code{project_id}). If \code{NULL}, you will be
prompted to choose columns interactively (unless \code{prompt = FALSE}).
The default suggestions are the first three columns that do not start
with \code{"form-"} or \code{"form_"}.
Tip: choose columns that are stable within a submission (not multi-row fields).}

\item{compare_cols}{Optional. Character or integer vector of columns to show
when comparing duplicates. If \code{NULL} (default), you will be prompted to
choose columns interactively (unless \code{prompt = FALSE}).}

\item{return_flat}{Logical. If \code{TRUE} and \code{x} came from \code{\link[=FlattenSubmissions]{FlattenSubmissions()}},
include the updated list as \code{flat} in the output.}

\item{quiet}{Logical. If \code{FALSE}, prints guidance and summaries.}

\item{keep_map}{Optional. Non-interactive decisions for which rows to keep,
keyed by submission ID. Supported formats:
\itemize{
\item Named list: \code{list(id1 = c(1,3), id2 = "all")}
\item Named character vector: \code{c(id1 = "1,3", id2 = "all")}
\item Data frame with columns \code{id} and \code{keep}
Values can be row numbers (within each duplicate group), ranges like \code{"1:3"},
or keywords \code{"all"} / \code{"none"}.
}}

\item{prompt}{Logical. If \code{TRUE} (default), ask interactively. If \code{FALSE},
uses \code{keep_map} and \code{default_keep} without prompting.}

\item{default_keep}{Default action when \code{prompt = FALSE} and no \code{keep_map}
entry exists for a given ID. Accepts the same formats as \code{keep_map} values.
Default \code{"all"}.}
}
\value{
A list with:
\describe{
\item{data}{Data frame after duplicate review}
\item{summary}{List with counts and whether the review stopped early}
\item{decisions}{Data frame describing what was kept/dropped for each ID}
\item{flat}{If \code{return_flat = TRUE} and \code{x} was a FlattenSubmissions list, the updated list}
}
}
\description{
This function walks you through duplicate groups defined by key columns
(for example \code{email}, \code{username}, \code{project_id}). For each duplicate group,
it shows selected columns so you can compare submissions and choose which
ones to keep. You can keep multiple submissions or drop all submissions
for a given group if needed.
}
\details{
This is designed for non-technical users who want full control over which
duplicates are kept. If you want an automatic (non-interactive) approach,
use \code{\link[=DeduplicateSubmissions]{DeduplicateSubmissions()}}.

If audit logging is active (see \code{\link[=StartAuditLog]{StartAuditLog()}}), each decision is logged.
}
\examples{
\dontrun{
flat <- FlattenSubmissions(GetResponses(form_id = "123", api_key = "abc"))
out <- ReviewDuplicateSubmissions(flat, id_col = "form_submissionid")
View(out$decisions)

# Non-interactive example (scriptable)
df <- data.frame(
  submissionId = c("a", "a", "b", "b", "b"),
  email = c("x@example.com", "x@example.com", "x@example.com", "x@example.com", "x@example.com"),
  status = c("draft", "final", "test", "final", "final"),
  stringsAsFactors = FALSE
)
# Group 1 will be the email=x@example.com group (the only group in this example)
keep_map <- list(`1` = 2)
out2 <- ReviewDuplicateSubmissions(
  df,
  id_col = "submissionId",
  key_cols = "email",
  compare_cols = c("submissionId", "email", "status"),
  keep_map = keep_map,
  prompt = FALSE,
  quiet = TRUE
)
}
}
